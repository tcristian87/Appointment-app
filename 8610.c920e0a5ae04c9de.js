"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8610],{8610:(P,v,a)=>{a.r(v),a.d(v,{AppointmentsEditPageModule:()=>T});var g=a(6019),p=a(9010),o=a(7328),m=a(1077),t=a(865),Z=a(9927);function f(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"ion-datetime",17,18),t.NdJ("ionChange",function(){t.CHM(e);const s=t.MAs(1),d=t.MAs(2),h=t.oxw();return[h.date=s.value,h.hour=d.value]}),t.qZA()}}const b=[{path:"",component:(()=>{class n{constructor(e,i,s,d){this.route=e,this.appointService=i,this.navCtrl=s,this.loadingCtrl=d,this.isLoading=!1}ngOnInit(){this.route.paramMap.subscribe(e=>{e.has("appointId")?(this.appointId=e.get("appointId"),this.isLoading=!0,this.appointSub=this.appointService.getAppoint(e.get("appointId")).subscribe(i=>{this.appoint=i,this.form=new p.cw({name:new p.NI(this.appoint.name,{updateOn:"blur",validators:[p.kI.required]}),phone:new p.NI(this.appoint.phone,{updateOn:"blur",validators:[p.kI.required]}),hour:new p.NI(this.appoint.hour,{updateOn:"blur",validators:[p.kI.required]}),date:new p.NI(this.appoint.date,{updateOn:"blur",validators:[p.kI.required]}),service:new p.NI(this.appoint.service,{updateOn:"blur",validators:[p.kI.required]})}),this.isLoading=!1})):this.navCtrl.navigateBack("/home/tabs/book-appointment")})}onUpdateAppoint(){!this.form.valid||this.loadingCtrl.create({message:"Updating appoint.."}).then(e=>{e.present(),this.appointService.updateAppoint(this.appoint.id,this.form.value.name,this.form.value.phone,this.form.value.hour,this.form.value.date,this.form.value.service).subscribe(()=>{e.dismiss(),this.form.reset(),this.navCtrl.navigateBack("/home/tabs/book-appointment"),console.log(this.form.value.hour),console.log(this.form.value.date)})})}ngOnDestroy(){this.appointSub&&this.appointSub.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.gz),t.Y36(Z.f),t.Y36(o.SH),t.Y36(o.HT))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-appointments-edit"]],decls:32,vars:7,consts:[["color","primary"],["slot","start"],["defaultHref","/home/tabs/book-appointment"],["slot","end"],[3,"disabled","click"],["name","checkmark"],[1,"ion-padding"],[3,"formGroup"],["size-sm","6","offset-sm","3"],["type","text","formControlName","name"],["type","text","formControlName","phone"],["slot","start","id","open-date-input-3"],["icon","calendar"],["formControlName","hour",3,"value"],["formControlName","date","slot","start",3,"value"],["trigger","open-date-input-3","show-backdrop","false"],["type","text","formControlName","service"],["presentation","time-date","formControlName","date","formControlName","hour",3,"ionChange"],["popoverDatetime","","popoverHour",""]],template:function(e,i){1&e&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar",0),t.TgZ(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-buttons",3),t.TgZ(5,"ion-button",4),t.NdJ("click",function(){return i.onUpdateAppoint()}),t._UZ(6,"ion-icon",5),t.qZA(),t.qZA(),t.TgZ(7,"ion-title"),t._uU(8,"Appointment Edit"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"ion-content",6),t.TgZ(10,"form",7),t.TgZ(11,"ion-col",8),t.TgZ(12,"ion-item"),t.TgZ(13,"ion-label"),t._uU(14,"Name "),t._UZ(15,"ion-input",9),t.qZA(),t.qZA(),t.TgZ(16,"ion-item"),t.TgZ(17,"ion-label"),t._uU(18,"Phone "),t._UZ(19,"ion-input",10),t.qZA(),t.qZA(),t.TgZ(20,"ion-item"),t.TgZ(21,"ion-button",11),t._UZ(22,"ion-icon",12),t.qZA(),t._UZ(23,"ion-input",13),t.ALo(24,"date"),t._UZ(25,"ion-input",14),t.TgZ(26,"ion-popover",15),t.YNc(27,f,3,0,"ng-template"),t.qZA(),t.qZA(),t.TgZ(28,"ion-item"),t.TgZ(29,"ion-label"),t._uU(30,"Service "),t._UZ(31,"ion-input",16),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.Q6J("disabled",!i.form.valid),t.xp6(5),t.Q6J("formGroup",i.form),t.xp6(13),t.Q6J("value",t.xi3(24,4,i.hour,"HH:mm")),t.xp6(2),t.Q6J("value",i.date))},directives:[o.Gu,o.sr,o.Sm,o.oU,o.cs,o.YG,o.gu,o.wd,o.W2,p._Y,p.JL,p.sg,o.wI,o.Ie,o.Q$,o.pK,o.j9,p.JJ,p.u,o.d8,o.x4,o.QI],pipes:[g.uU],styles:[""]}),n})()}];let I=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[m.Bz.forChild(b)],m.Bz]}),n})(),T=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[g.ez,o.Pc,I,p.UX]]}),n})()},9927:(P,v,a)=>{a.d(v,{f:()=>T});var g=a(8053),p=a(5722),o=a(6636),m=a(9204),t=a(4099),Z=a(2411);class f{constructor(r,e,i,s,d,h,c){this.id=r,this.name=e,this.phone=i,this.hour=s,this.date=d,this.service=h,this.userId=c}}var A=a(865),b=a(7079),I=a(4522);let T=(()=>{class n{constructor(e,i){this.authService=e,this.http=i,this._appoints=new t.X([])}get appoints(){return this._appoints.asObservable()}fetchAppoints(){return this.http.get("https://ionic-appoint-app-default-rtdb.europe-west1.firebasedatabase.app/appoints.json").pipe((0,g.U)(e=>{const i=[];for(const s in e)e.hasOwnProperty(s)&&i.push(new f(s,e[s].name,e[s].phone,e[s].hour,e[s].date,e[s].service,e[s].userId));return i}),(0,p.b)(e=>{this._appoints.next(e)}))}getAppoint(e){return this.appoints.pipe((0,o.q)(1),(0,g.U)(i=>Object.assign({},i.find(s=>s.id===e))))}addAppoint(e,i,s,d,h){let c;const l=new f(Math.random().toString(),e,i,s,d,h,this.authService.userId);return this.http.post("https://ionic-appoint-app-default-rtdb.europe-west1.firebasedatabase.app/appoints.json",Object.assign(Object.assign({},l),{id:null})).pipe((0,m.w)(u=>(c=u.name,this.appoints)),(0,o.q)(1),(0,p.b)(u=>{l.id=c,this._appoints.next(u.concat(l))}))}updateAppoint(e,i,s,d,h,c){let l;return this.appoints.pipe((0,o.q)(1),(0,m.w)(u=>!u||u.length<=0?this.fetchAppoints():(0,Z.of)(u)),(0,m.w)(u=>{const U=u.findIndex(S=>S.id===e);l=[...u];const C=l[U];return l[U]=new f(C.id,i,s,d,h,c,C.userId),this.http.put(`https://ionic-appoint-app-default-rtdb.europe-west1.firebasedatabase.app/appoints/${e}.json`,Object.assign(Object.assign({},l[U]),{id:null}))}),(0,p.b)(()=>{this._appoints.next(l)}))}}return n.\u0275fac=function(e){return new(e||n)(A.LFG(b.e),A.LFG(I.eN))},n.\u0275prov=A.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()}}]);